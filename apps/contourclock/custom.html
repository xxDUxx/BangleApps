<html>
<head>
  <link rel="stylesheet" href="../../css/spectre.min.css">
  <style>
    input[type=checkbox] {
      opacity:0;
    }
    input[type=checkbox] + label {
      opacity:0.2;
    }
    input[type=checkbox]:checked + label {
      opacity:1;
    }
  </style>
</head>
<body>
  <h1>&nbsp;&nbsp;&nbsp;Select Fonts to upload:</h1>
  <form>
    <script src="../../core/lib/customize.js"></script>
    <script>
      var settings;
      function onInit() {
        console.log("debug 1");
        Util.readStorageJSON("contourclock.json",s => {
          settings=s;
          console.log(settings);
        });
        //get installed and selected fonts. 
      }
      console.log("TEST 3");
      const FontList = ["Teko", "LuckiestGuy", "Bangers", "RubikOne", "Oswald", "Anton", "TitanOne", "BarlowCond", "BebasNeue", "Dekko", "DinAlternate",
      "Impact", "Nunito", "OpenSansEC", "Phosphate", "Quicksand", "SairaEC",
      "Yumaro", "YuseiMagic", "MouseMemoirs", "ArchivoNarrow", "FjallaOne", "NerkoOne"];
      for (fontName of FontList) {
        var cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.id = fontName;
        cb.name = "font"
        var lb = document.createElement('label');
        lb.setAttribute("for",fontName);
        var img1 = document.createElement('img')
        img1.src = "fonts/"+fontName+"-p1.png";
        var img2 = document.createElement('img')
        img2.src = "fonts/"+fontName+"-p2.png";
        lb.appendChild(img1);
        lb.appendChild(img2);
        document.forms[0].appendChild(cb);
        document.forms[0].appendChild(lb);
        document.forms[0].appendChild(document.createElement('br'));
      }
      btn=document.createElement('button');
      btn.id="upload";
      btn.innerHTML="Upload selected Fonts";
      btn.addEventListener("click", function() {
        var n=0;
        var fontFiles = [];
        var fontList = [];
        for (fontElement of document.getElementsByName("font")) {
          if (fontElement.checked==true) {
            fontList.push(fontElement.id);
            fontFiles.push({
              name:"contourclock.f."+fontElement.id+".js",
              url:"fonts/font-"+fontElement.id+".json"
            });
            n++;
          }
        }
        if (n>0) {
          settings.fontList=fontList;
          sendCustomizedApp({storage:fontFiles});
          Util.writeStorage("countourclock.json",settings);
        } else {
          alert("Please select at least one Font!");
        }
    });
    document.forms[0].appendChild(btn);
    </script>
  </form>
</body>
</html>
